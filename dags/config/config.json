{
  "name": "demo_dynamic_dag",
  "nodes": [
    {
      "name": "Start",
      "_type": "DummyOperator",
      "parameters": {}
    },
    {
      "name": "End",
      "_type": "DummyOperator",
      "parameters": {}
    },
    {
      "name": "ExecuteBashCommand",
      "_type": "BashOperator",
      "parameters": {
        "bash_command": "echo test"
      }
    },
    {
      "name": "ExecutePythonCode",
      "_type": "PythonOperator",
      "parameters": {},
      "func": "log_details"
    },
    {
      "name": "ExecuteSparkCode",
      "_type": "SparkSubmitOperator",
      "parameters": {
        "conn_id": "spark_default",
        "application": "/opt/airflow/dags/spark_example.py"
      }
    }
  ],
  "connections": {
    "Start": ["ExecuteBashCommand"],
    "ExecuteBashCommand": ["ExecuteSparkCode"],
    "ExecuteSparkCode": ["ExecutePythonCode"],
    "ExecutePythonCode": ["End"]
  }
}
